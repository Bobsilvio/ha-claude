version: "3.8"

services:
  home-assistant:
    image: homeassistant/home-assistant:latest
    container_name: home-assistant
    ports:
      - "8123:8123"
    volumes:
      - ./config:/config
      - /etc/localtime:/etc/localtime:ro
    environment:
      - TZ=UTC
    restart: unless-stopped

  claude-api:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: claude-api
    ports:
      - "5000:5000"
    environment:
      - HA_URL=http://home-assistant:8123
      - HA_TOKEN=${HA_TOKEN}
      - API_PORT=5000
      - DEBUG_MODE=False
    depends_on:
      - home-assistant
    restart: unless-stopped
    env_file:
      - .env
